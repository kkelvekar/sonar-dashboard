<div class="card-custom">
  <div class="card-header">
    <h5>
      <a href="#">{{ projectItem.projectName }}</a>
      <span
        class="badge ms-2"
        [ngClass]="isAlertStatusPassed() ? 'passed-badge' : 'failed-badge'"
      >
        {{ getMetricValue('alert_status')?.toString() | uppercase }}
      </span>
    </h5>
    <!-- Lines of Code moved to header -->
    <div class="loc" *ngIf="getMetricValue('ncloc')">
      <i class="metric-icon bi bi-file-earmark-lines"></i>
      <span class="metric-value">{{ getMetricValue('ncloc') }} Lines of code</span>
    </div>
  </div>

  <div class="metrics-row">
    <!-- Bugs Metric -->
    <div class="metric-item" *ngIf="getMetricValue('bugs')">
      <div class="metric-header">
        <i class="metric-icon bi bi-bug"></i>
        <div class="metric-title">Bugs</div>
      </div>
      <div class="metric-content">
        <div
          class="metric-rating"
          [ngClass]="getRatingValue('reliability_rating')"
        >
          {{ getMetricValue('reliability_rating') }}
        </div>
        <div class="metric-value">{{ getMetricValue('bugs') }}</div>
      </div>
    </div>

    <!-- Vulnerabilities Metric -->
    <div class="metric-item" *ngIf="getMetricValue('vulnerabilities')">
      <div class="metric-header">
        <i class="metric-icon bi bi-lock"></i>
        <div class="metric-title">Vulnerabilities</div>
      </div>
      <div class="metric-content">
        <div
          class="metric-rating"
          [ngClass]="getRatingValue('security_rating')"
        >
          {{ getMetricValue('security_rating') }}
        </div>
        <div class="metric-value">{{ getMetricValue('vulnerabilities') }}</div>
      </div>
    </div>

    <!-- Hotspots Reviewed Metric -->
    <div class="metric-item" *ngIf="getMetricValue('security_hotspots')">
      <div class="metric-header">
        <i class="metric-icon bi bi-shield-shaded"></i>
        <div class="metric-title">Hotspots Reviewed</div>
      </div>
      <div class="metric-content">
        <div
          class="metric-rating"
          [ngClass]="getRatingValue('security_review_rating')"
        >
          {{ getRatingValue('security_review_rating') }}
        </div>
        <div class="metric-value">
          {{ getMetricValue('security_hotspots') }}%
        </div>
      </div>
    </div>

    <!-- Code Smells Metric -->
    <div class="metric-item" *ngIf="getMetricValue('code_smells')">
      <div class="metric-header">
        <i class="metric-icon bi bi-radioactive"></i>
        <div class="metric-title">Code Smells</div>
      </div>
      <div class="metric-content">
        <div
          class="metric-rating"
          [ngClass]="getRatingValue('sqale_rating')"
        >
          {{ getMetricValue('sqale_rating') }}
        </div>
        <div class="metric-value">{{ getMetricValue('code_smells') }}</div>
      </div>
    </div>

    <!-- Coverage Metric with Adjusted Circular Graph -->
    <div class="metric-item" *ngIf="getMetricValue('coverage')">
      <div class="metric-header">
        <i class="metric-icon bi bi-percent"></i>
        <div class="metric-title">Coverage</div>
      </div>
      <div class="metric-content">
        <div class="circular-chart tiny">
          <svg viewBox="0 0 36 36">
            <path
              class="circle-bg"
              d="
                M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831
              "
            ></path>
            <path
              class="circle"
              [attr.stroke-dasharray]="getMetricValue('coverage') + ', 100'"
              d="
                M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831
              "
            ></path>
          </svg>
        </div>
        <div class="metric-value">{{ getMetricValue('coverage') }}%</div>
      </div>
    </div>

    <!-- Duplication Metric with Adjusted Circular Graph -->
    <div class="metric-item" *ngIf="getMetricValue('duplicated_lines_density')">
      <div class="metric-header">
        <i class="metric-icon bi bi-files"></i>
        <div class="metric-title">Duplication</div>
      </div>
      <div class="metric-content">
        <div class="circular-chart tiny">
          <svg viewBox="0 0 36 36">
            <path
              class="circle-bg"
              d="
                M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831
              "
            ></path>
            <path
              class="circle"
              [attr.stroke-dasharray]="getMetricValue('duplicated_lines_density') + ', 100'"
              d="
                M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831
              "
            ></path>
          </svg>
        </div>
        <div class="metric-value">
          {{ getMetricValue('duplicated_lines_density') }}%
        </div>
      </div>
    </div>
  </div>
</div>
